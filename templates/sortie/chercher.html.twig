{% extends 'document.html.twig' %}

{% block title %}Sortir - Recherche{% endblock %}

{% block body %}

    <div class="container">
        <div class="filters filtres-recherche">

        {{ form_start(createArticleForm) }}
        {{ form_widget(createArticleForm) }}
            {#
            <input type="submit" value="Rechercher">
            #}
        {{ form_end(createArticleForm) }}

        </div>
        <div class="item-list list-recherche-sortie">
            {% if results %}
                <div class="item-list-titlebar">
                    <span>Nom de la sortie</span>
                    <span>Date de la sortie</span>
                    <span>Clôture</span>
                    <span>inscrits/places</span>
                    <span>Etat</span>
                    <span>Inscrit</span>
                    <span>Organisateur</span>
                    <span>Actions</span>
                </div>
                {%  for r in results %}
                    <div class="list-item">
                        <span>{{ r.sortie.nom }}</span>
                        <span>{{ r.sortie.datedebut | date('d/m/Y')}}</span>
                        <span>{{ r.sortie.datecloture | date('d/m/Y') }}</span>
                        <span>{{ r.participants_count }}/{{ r.sortie.nbinscriptionsmax }}</span>
                        <span>{{ r.sortie.etat.libelle }}</span>
                        <span>{{ r.user_inscrit }}</span>
                        <span>{{ r.sortie.organisateur.pseudo }}</span>
                        <span>
                            {% if r.sortie.etat.id == 4 and r.sortie.organisateur.id == user.id  %}
                                <a href="">modifier</a>
                                <a href="{{ path('cancelSortie',{ 'id': r.sortie.id }) }}">annuler</a>
                            {% else %}
                                <a href="{{ path('sortie_get_by_id_1',{ 'id': r.sortie.id }) }}">afficher</a>
                            {% endif %}

                            {% if r.sortie.etat.id == 1 and r.user_inscrit == 0  %}
                                <a href="{{ path('joinSortie',{ 'id': r.sortie.id }) }}">s'inscrire</a>
                            {% elseif r.sortie.etat.id == 1 and r.user_inscrit == 1 %}
                                <a href="{{ path('leaveSortie',{ 'id': r.sortie.id }) }}">se désinscrire</a>
                            {% endif %}
                        </span>
                    </div>
                {% else %}
                {% endfor %}
            {% endif%}
        </div>
        <div class="padded-body-block">
            <a href="{{ path('createSortie')}}" class="btn btn-primary">Créer une Sortie</a>
        </div>
    </div>
{% endblock %}
